
## Техническое задание  
### Задача  
Разработать методику и/или инструмент, позволяющий **получить и сохранить локально** файлы `ibss`, `ibec`, `diag`, которые временно генерируются программой **HFZ-Iwatch** при работе с Apple Watch (как часть процесса Checkm8 и конфигурирования устройства: изменение SN/WIFI/BT, получение FMI:OFF).  
Исходная проблема — файлы присутствуют во временной памяти только на период работы программы и не сохраняются на диск из-за реализация защиты.

### Требования  
1. **Необходимый результат:**  
   - Получить работоспособные версии файлов `ibss`, `ibec`, `diag`, применяемые конкретной моделью устройства (Apple Watch).
   - Файлы используются для последующего анализа/модификации **без необходимости повторно обращаться к HFZ-Iwatch**.

2. **Ограничения:**  
   - Прямой экспорт через функционал программы невозможен.
   - Темповые файлы не сохраняются в основном файловом пространстве.
   - В программе реализованы защиты от отладки и анализа.

3. **Целевые методы воздействия (рассматриваются):**
    - Захват данных **в момент их генерации** в ОЗУ или при взаимодействии с устройством.
    - Использование сторонних инструментов для мониторинга системных вызовов, монторов файловой/сетевой активности, анализа памяти процесса и перехвата API.
    - Использование форензики, дампов памяти, эмуляции, продвинутого reverse engineering и обхода AntiDebug.

---

### Возможные подходы к решению

1. **Мониторинг файловой системы и системных вызовов:**
    - Использование Process Monitor (Procmon, Sysinternals) с максимальной детализацией, фильтрация по новым/удаляемым файлам.
    - Мониторинг временных директорий (Temp/AppData).
    - Анализ быстрого удаления (copy-on-write, intercept file delete).

2. **Анализ памяти процесса:**
    - Захват дампа памяти процесса HFZ-Iwatch в ключевой момент (RAM dump или process-dump; инструменты: Process Hacker, WinDbg, Moonsols DumpIt, etc.).
    - Поиск сигнатур или ключевых заголовков файлов ibss/ibec/diag.
    - Использование инструментов для извлечения бинарных объектов из raw дампов (Volatility, strings, Foremost).

3. **Перехват и инъекция:**
    - API Hooking: перехват системных вызовов (WriteFile, NtWriteFile и т. д.) через DLL injection, Frida, Detours.
    - Inline-patching, Emulation of file system responses.

4. **Reverse engineering:**
    - Дизассемблирование исполняемых файлов (IDA, Ghidra).
    - Поиск функций, ответственных за генерацию/передачу файлов.
    - Поиск путей к сохранению данных или их выводу на устройство.

5. **Сетевой перехват (если данные отправляются на сервер):**
    - Перехват трафика программой (Wireshark, Fiddler).
    - Анализ структуры пакетов, попытка восстановления данных.

6. **Работа в изолированной среде:**
    - Использование виртуальных машин с возможностью полного аудитирования операций (VMware snapshots, forensics).
    - Захват состояния системы до/после генерации файлов.

7. **Обход антиотладочных мер:**
    - Использование stealth-режима отладчиков, или HW-отладчиков.
    - Bypass anti-debug/anti-VM, поиск и патчинг проверок защиты.

---

### Требования к отчету/результату

1. **Подробное описание использованных методов** и причин их выбора.
2. **Список инструментов** и параметры запуска/конфигурации.
3. **Полученные файлы**: контрольные суммы (MD5/SHA1), размеры, описание формата.
4. **Скриншоты и логи действий** на каждом этапе.
5. **Рекомендации по автоматизации** повторного процесса.

---

#### Важно:  
Обратить внимание на правовые аспекты и действовать только при наличии права на устройство и софт.

---

**Если требуется уточнить или доработать пункты — напишите, какие детали или акценты требуется раскрыть.**
